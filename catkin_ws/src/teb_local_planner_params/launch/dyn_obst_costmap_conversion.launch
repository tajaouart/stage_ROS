<launch>
  <arg name="map_file"  default="eytre2"/>

  <!--  ************** Global Parameters ***************  -->
  


  <arg name="paused" default="false"/>
  <arg name="use_sim_time" default="true"/>
  <arg name="gui" default="true"/>
  <arg name="headless" default="false"/>
  <arg name="debug" default="false"/>



  <!--  ******************* Maps ***********************  -->
  <node name="map_server" pkg="map_server" type="map_server" args="$(find teb_local_planner_params)/maps/$(arg map_file).yaml" output="screen">
    <param name="frame_id" value="map"/>
  </node>

  <!-- ******** Localization ********* -->
  <!-- See stage world file for initial poses -->



   <!--  ************* Navigation Ego Robot ************  -->
  <group>
    <!-- work around for footprint reload -->
    <rosparam command="delete" ns="move_base" />

    <node pkg="move_base" type="move_base" respawn="false" name="move_base" output="screen">
      <rosparam file="$(find teb_local_planner_params)/cfg/diff_drive/costmap_common_params.yaml" command="load" ns="global_costmap" />
      <rosparam file="$(find teb_local_planner_params)/cfg/diff_drive/costmap_common_params.yaml" command="load" ns="local_costmap" />
      <rosparam file="$(find teb_local_planner_params)/cfg/diff_drive/dyn_obst/local_costmap_params.yaml" command="load" />
      <rosparam file="$(find teb_local_planner_params)/cfg/diff_drive/dyn_obst/global_costmap_params.yaml" command="load" />
      <rosparam file="$(find teb_local_planner_params)/cfg/diff_drive/dyn_obst/teb_local_planner_params.yaml" command="load" />
      <!-- Here we load our costmap conversion settings -->
      <!--rosparam file="$(find teb_local_planner_params)/cfg/diff_drive/dyn_obst/costmap_converter_params.yaml" command="load" /-->

      <param name="base_local_planner" value="teb_local_planner/TebLocalPlannerROS" />
      <param name="controller_frequency" value="5.0" />
      <param name="controller_patience" value="15.0" />
      <remap from="map" to="/map"/>
    </node>
  </group>

  <!-- ******************* Obstacles ******************* -->
 

  <node name="standalone_converter" pkg="costmap_converter" type="standalone_converter" output="screen">
    <param name="converter_plugin" value="costmap_converter::CostmapToDynamicObstacles" />
    <param name="costmap_topic" value="/move_base/local_costmap/costmap" />
    <param name="odom_topic" value="/mavros/global_position/local" />
  </node>

  <!--  **************** Visualisation ****************  -->
  <node name="rviz" pkg="rviz" type="rviz" args="-d $(find teb_local_planner_params)/cfg/rviz_navigation_cc.rviz">
    <remap from="/move_base_simple/goal" to="/move_base_simple/goal" />
  </node>


 <node pkg="tf" type="static_transform_publisher" name="map_odom_tf" args="0 0 0 0 0 0  /base_link  /map 100" />





</launch>
